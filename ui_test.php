<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.o\
rg/TR/html4/loose.dtd">
<html>
    <head>
  <style type="text/css">
  
 

a:link {
  text-decoration: none;
 color: black;
 }

.pcNameInputBox{
 position:relative;
 }

.pcIPInputBox{
 position:relative;
 }

.pcPortInputBox{
 position:relative;
 }

.pcAddButton{
 position:relative;
 left: 5px;
 top: 3px;
 line-height: 1;
 text-decoration:none;
 display: inline-block;
 padding: 4px 6px;
 font-family: Arial, sans-serif;
 text-transform:uppercase;
 font-size:12px;
 letter-spacing:1px;
 color:#fff;
 cursor:pointer;
 border-radius: 5px;
 -webkit-border-radius: 5px;
 box-shadow: 0 1px 3px rgba(0,0,0,0.40);
 -webkit-box-shadow: 0 1px 3px rgba(0,0,0,0.40);
 text-shadow: -1px -1px 0px rgba(0,0,0,0.15);
 background: #76bbc5 url('../images/overlay.png') left top repeat-x;
 background-image: -moz-linear-gradient(100% 100% 90deg, #76bbc5, #9ecbd1);
 background-image: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#9ecbd1), to(#76bbc5));
 }

.pcAddButton:hover {
 opacity:0.9;
 }


.threadTemplateAddButton{
 position:relative;
 left: 5px;
 top: 3px;
 line-height: 1;
 text-decoration:none;
 display: inline-block;
 padding: 4px 6px;
 font-family: Arial, sans-serif;
 text-transform:uppercase;
 font-size:12px;
 letter-spacing:1px;
 color:#fff;
 cursor:pointer;
 border-radius: 5px;
 -webkit-border-radius: 5px;
 box-shadow: 0 1px 3px rgba(0,0,0,0.40);
 -webkit-box-shadow: 0 1px 3px rgba(0,0,0,0.40);
 text-shadow: -1px -1px 0px rgba(0,0,0,0.15);
 background: #76bbc5 url('../images/overlay.png') left top repeat-x;
 background-image: -moz-linear-gradient(100% 100% 90deg, #76bbc5, #9ecbd1);
 background-image: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#9ecbd1), to(#76bbc5));
 }

.threadTemplateAddButton:hover {
 opacity:0.9;
 }

.mmTemplateAddButton{
 position:relative;
 left: 5px;
 top: 3px;
 line-height: 1;
 text-decoration:none;
 display: inline-block;
 padding: 4px 6px;
 font-family: Arial, sans-serif;
 text-transform:uppercase;
 font-size:12px;
 letter-spacing:1px;
 color:#fff;
 cursor:pointer;
 border-radius: 5px;
 -webkit-border-radius: 5px;
 box-shadow: 0 1px 3px rgba(0,0,0,0.40);
 -webkit-box-shadow: 0 1px 3px rgba(0,0,0,0.40);
 text-shadow: -1px -1px 0px rgba(0,0,0,0.15);
 background: #76bbc5 url('../images/overlay.png') left top repeat-x;
 background-image: -moz-linear-gradient(100% 100% 90deg, #76bbc5, #9ecbd1);
 background-image: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#9ecbd1), to(#76bbc5));
 }

.mmTemplateAddButton:hover {
 opacity:0.9;
 }


 .pcRemoveButton{
 position:absolute;
 left:430px;
 top:2px;
 line-height: 1;
 text-decoration:none;
 display: inline-block;
 padding: 2px 4px;
 font-family: Arial, sans-serif;
 text-transform:uppercase;
 font-size:10px;
 letter-spacing:1px;
 color:#fff;
 cursor:pointer;
 border-radius: 5px;
 -webkit-border-radius: 5px;
 box-shadow: 0 1px 3px rgba(0,0,0,0.40);
 -webkit-box-shadow: 0 1px 3px rgba(0,0,0,0.40);
 text-shadow: -1px -1px 0px rgba(0,0,0,0.15);
 background: #ff6699 url('../images/overlay.png') left top repeat-x;
 background-image: -moz-linear-gradient(100% 100% 90deg, #ff6699, #ff6699);
 background-image: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#ff6699), to(#ff6699));
 }

 .pcRemoveButton:hover{
 opacity:0.9;
 }

 .threadRemoveButton{      
 position:absolute;
 left:430px;
 top:2px;
 line-height: 1;
 text-decoration:none;
 display: inline-block;
 padding: 2px 4px;
 font-family: Arial, sans-serif;
 text-transform:uppercase;
 font-size:10px;
 letter-spacing:1px;
 color:#fff;
 cursor:pointer;
 border-radius: 5px;
 -webkit-border-radius: 5px;
 box-shadow: 0 1px 3px rgba(0,0,0,0.40);
 -webkit-box-shadow: 0 1px 3px rgba(0,0,0,0.40);
 text-shadow: -1px -1px 0px rgba(0,0,0,0.15);
 background: #ff6699 url('../images/overlay.png') left top repeat-x;
 background-image: -moz-linear-gradient(100% 100% 90deg, #ff6699, #ff6699);
 background-image: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#ff6699), to(#ff6699));
 }

.threadRemoveButton:hover{
opacity:0.9;
}

				    .mmRemoveButton{
				    position:absolute;
				    left:430px;
				    top:2px;
				      line-height: 1;
				      text-decoration:none;
				    display: inline-block;
				    padding: 2px 4px;
				      font-family: Arial, sans-serif;
				      text-transform:uppercase;
				      font-size:10px;
				      letter-spacing:1px;
				    color:#fff;
				    cursor:pointer;
				      border-radius: 5px;
				      -webkit-border-radius: 5px;
				      box-shadow: 0 1px 3px rgba(0,0,0,0.40);
				      -webkit-box-shadow: 0 1px 3px rgba(0,0,0,0.40);
				      text-shadow: -1px -1px 0px rgba(0,0,0,0.15);
				    background: #ff6699 url('../images/overlay.png') left top repeat-x;
				      background-image: -moz-linear-gradient(100% 100% 90deg, #ff6699, #ff6699);
									     background-image: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#ff6699), to(#ff6699));
																	     }
									     .mmRemoveButton:hover{
														opacity:0.9;
														}

 .addThreadButton{
 position:relative;
 left:2px;
 top:2px;
 line-height: 2;
 text-decoration:none;
 display: inline-block;
 padding: 2px 4px;
 font-family: Arial, sans-serif;
 text-transform:uppercase;
 font-size:10px;
 letter-spacing:1px;
 color:#fff;
 cursor:pointer;
 border-radius: 5px;
 -webkit-border-radius: 5px;
 box-shadow: 0 1px 3px rgba(0,0,0,0.40);
 -webkit-box-shadow: 0 1px 3px rgba(0,0,0,0.40);
 text-shadow: -1px -1px 0px rgba(0,0,0,0.15);
 background: #76bbc5 url('../images/overlay.png') left top repeat-x;
 background-image: -moz-linear-gradient(100% 100% 90deg, #76bbc5, #9ecbd1);
 background-image: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#9ecbd1), to(#76bbc5));

 }

.addThreadButton:hover {
 opacity:0.9;
 }

.goButton{
 position:absolute;
 left: 700px;
 top: 10px;
 line-height: 1;
 text-decoration:none;
 display: inline-block;
 padding: 8px 12px;
 font-family: Arial, sans-serif;
 text-transform:uppercase;
 font-size:22px;
 letter-spacing:1px;
 color:#fff;
 cursor:pointer;
 border-radius: 5px;
 -webkit-border-radius: 5px;
 box-shadow: 0 1px 3px rgba(0,0,0,0.40);
 -webkit-box-shadow: 0 1px 3px rgba(0,0,0,0.40);
 text-shadow: -1px -1px 0px rgba(0,0,0,0.15);
 background: #9dc773 url('../images/overlay.png') left top repeat-x;
 background-image: -moz-linear-gradient(100% 100% 90deg, #9dc773, #afd18c);								 
 background-image: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#afd18c), to(#9dc773));			      			  	    
 }

.goButton:hover {
 opacity:0.9;
 }

				    /*
.pcSlideBox
  {
  z-index:0;
  background-color:#FFFFFF;
  width:500px;
  overflow:auto;
  position:relative;
  }

//Took these out for formatting: they showed up in weird ways
/*
.createPC_SlideBox
  {
  z-index:9999;
  background-color:#FFFFFF;
  width:330px;
  overflow:auto;
  position:absolute;
  }

.createThread_SlideBox
  {
  z-index:9999;
  background-color:#FFFFFF;
  width:250px;
  overflow:auto;
  position:absolute;
  }

.createThreadTemplate_SlideBox
  {
  z-index:99999;
  background-color:#FFFFFF;
  width:330px;
  overflow:auto;
  position:absolute;
  }

.createMMTemplate_SlideBox
  {
  z-index:9999;
  background-color:#FFFFFF;
  width:330px;
  overflow:auto;
  position:absolute;
  }

*/

.pcbutton
{
position:relative;
top:100px;
left: 10px;
width: 500px;
font-size: 20px;
font-family: Georgia;
text-decoration:none;
text-align: left;
background:-webkit-gradient(linear,0% 0%,0% 100%,from(rgba(255,255,255,1)),to(rgba(185,185,185,1)));
background:-moz-linear-gradient(top,rgba(255,255,255,1),rgba(185,185,185,1));
border-radius: 5px;  
webkit-border-radius: 5px;  			
box-shadow: 0 1px 3px rgba(0,0,0,0.5);  
-webkit-box-shadow: 0 0px 2px rgba(0,0,0,0.5);
box-shadow: 0 1px 3px black;  
}

.newpcbutton
{
position:relative;
top:100px;
left:10px;
width: 500px;
font-size: 20px;
font-family: Georgia;
text-decoration:none;
text-align: left;
background:-webkit-gradient(linear,0% 0%,0% 100%,from(rgba(255,255,255,1)),to(rgba(185,185,185,1)));
background:-moz-linear-gradient(top,rgba(255,255,255,1),rgba(185,185,185,1));
border-radius: 5px;  
-webkit-border-radius: 5px;  			
box-shadow: 0 1px 3px rgba(0,0,0,0.5);  
-webkit-box-shadow: 0 0px 2px rgba(0,0,0,0.5);
box-shadow: 0 1px 3px black;  
}

.runMenu
{
position:absolute;
left:240px;
top:10px;
width: 200px;
font-size:15px;
color:#686868;
border:none;
font-family: Georgia;
text-decoration:none;
text-align: left;
background:-webkit-gradient(linear,0% 0%,0% 100%,from(rgba(255,255,255,1)),to(rgba(185,185,185,1)));
background:-moz-linear-gradient(top,rgba(255,255,255,1),rgba(185,185,185,1));
border-radius: 5px;  
-webkit-border-radius: 5px;  			
box-shadow: 0 1px 3px rgba(0,0,0,0.5);  
-webkit-box-shadow: 0 0px 2px rgba(0,0,0,0.5);
box-shadow: 0 1px 3px black;  
}


.runCopyBox
{
position:absolute;
width:215px;
height:35px; 
top:4px;
border:2px solid red;
margin:0px;
paddng:0px;
}


.runCopyMenu
{
position:relative;
left:5px;
top:4px;
width: 200px;
font-size:15px;
color:#686868;
border:none;
font-family: Georgia;
text-decoration:none;
text-align: left;
background:-webkit-gradient(linear,0% 0%,0% 100%,from(rgba(255,255,255,1)),to(rgba(185,185,185,1)));
background:-moz-linear-gradient(top,rgba(255,255,255,1),rgba(185,185,185,1));
border-radius: 5px;  
-webkit-border-radius: 5px;  			
box-shadow: 0 1px 3px rgba(0,0,0,0.5);  
-webkit-box-shadow: 0 0px 2px rgba(0,0,0,0.5);
box-shadow: 0 1px 3px black;  
}

.threadMenu
{
position:relative;;
left:10px;
top:1px;
width:125px;
font-size:15px;
color:#686868;
border:none;
font-family: Georgia;
text-decoration:none;
text-align: left;
background:-webkit-gradient(linear,0% 0%,0% 100%,from(rgba(255,255,255,1)),to(rgba(185,185,185,1)));
background:-moz-linear-gradient(top,rgba(255,255,255,1),rgba(185,185,185,1));
border-radius: 5px;  
-webkit-border-radius: 5px;  			
box-shadow: 0 1px 3px rgba(0,0,0,0.5);  
-webkit-box-shadow: 0 0px 2px rgba(0,0,0,0.5);
box-shadow: 0 1px 3px black;  
}


.createPC_Menu
{
position:absolute;
left:680px;
top:65px;
width: 280px;
font-size:15px;
font-family: Georgia;
text-decoration:none;
text-align: left;
background:-webkit-gradient(linear,0% 0%,0% 100%,from(rgba(255,255,255,1)),to(rgba(185,185,185,1)));
background:-moz-linear-gradient(top,rgba(255,255,255,1),rgba(185,185,185,1));
border-radius: 5px;  
-webkit-border-radius: 5px;  			
box-shadow: 0 1px 3px rgba(0,0,0,0.5);  
-webkit-box-shadow: 0 0px 2px rgba(0,0,0,0.5);
box-shadow: 0 1px 3px black;  
}

.createThreadTemplate_Menu
{
z-index:9999;
position:absolute;
left:10px;
top:65px;
width: 310px;
font-size:15px;
font-family: Georgia;
text-decoration:none;
text-align: left;
background:-webkit-gradient(linear,0% 0%,0% 100%,from(rgba(255,255,255,1)),to(rgba(185,185,185,1)));
background:-moz-linear-gradient(top,rgba(255,255,255,1),rgba(185,185,185,1));
border-radius: 5px;  
-webkit-border-radius: 5px;  			
box-shadow: 0 1px 3px rgba(0,0,0,0.5);  
-webkit-box-shadow: 0 0px 2px rgba(0,0,0,0.5);
box-shadow: 0 1px 3px black;  
}

.createMMTemplate_Menu
{
position:absolute;
left:330px;
top:65px;
width: 340px;
font-size:15px;
font-family: Georgia;
text-decoration:none;
text-align: left;
background:-webkit-gradient(linear,0% 0%,0% 100%,from(rgba(255,255,255,1)),to(rgba(185,185,185,1)));
background:-moz-linear-gradient(top,rgba(255,255,255,1),rgba(185,185,185,1));
border-radius: 5px;  
-webkit-border-radius: 5px;  			
box-shadow: 0 1px 3px rgba(0,0,0,0.5);  
-webkit-box-shadow: 0 0px 2px rgba(0,0,0,0.5);
box-shadow: 0 1px 3px black;  
}

.createThread_Menu
{
position:absolute;
left:20px;
top:10px;
width: 330px;
font-size:15px;
font-family: Georgia;
text-decoration:none;
text-align: left;
background:-webkit-gradient(linear,0% 0%,0% 100%,from(rgba(255,255,255,1)),to(rgba(185,185,185,1)));
background:-moz-linear-gradient(top,rgba(255,255,255,1),rgba(185,185,185,1));
border-radius: 5px;  
-webkit-border-radius: 5px;  			
box-shadow: 0 1px 3px rgba(0,0,0,0.5);  
-webkit-box-shadow: 0 0px 2px rgba(0,0,0,0.5);
box-shadow: 0 1px 3px black;  
}

.threadbox
{
position:relative;
width: 500px;
top:50px;
font-size: 17px;
font-family: Georgia;
text-decoration:none;
text-align: left;
background:-webkit-gradient(linear,0% 0%,0% 100%,from(rgba(0,230,100,1.0)),to(rgba(0,230,100,1.0)));
background:-moz-linear-gradient(top,rgba(0,230,100,1),rgba(0,230,100,1));
border-radius: 5px;  
-webkit-border-radius: 5px;  			
box-shadow: 0 1px 3px rgba(0,0,0,0.5);  
-webkit-box-shadow: 0 0px 2px rgba(0,0,0,0.5);
box-shadow: 0 1px 3px black;  
}

				    .mmbox
				    {
				    position:relative;
				    width: 500px;
				    top:50px;
				      font-size: 17px;
				      font-family: Georgia;
				      text-decoration:none;
				      text-align: left;
				    background:-webkit-gradient(linear,0% 0%,0% 100%,from(rgba(95,158,160,1.0)),to(rgba(95,158,160,1.0)));
				    background:-moz-linear-gradient(top,rgba(95,158,160,1),rgba(95,158,160,1));
				      border-radius: 5px;
				      -webkit-border-radius: 5px;
				      box-shadow: 0 1px 3px rgba(0,0,0,0.5);
				      -webkit-box-shadow:0 0px 2px rgba(0,0,0,0.5);
				      box-shadow: 0 1px 3px black;
				    }

.templatebox
{
position:relative;
width: 500px;
font-size: 20px;
font-family: Georgia;
text-decoration:none;
text-align: left;
color: #FFFFFF;
background:-webkit-gradient(linear,0% 0%,0% 100%,from(rgba(128,0,128,1.0)),to(rgba(128,0,128,1.0)));
background:-moz-linear-gradient(top,rgba(128,0,128,1),rgba(128,0,128,1));
border-radius: 5px;  
-webkit-border-radius: 5px;  			
box-shadow: 0 1px 3px rgba(0,0,0,0.5);  
-webkit-box-shadow: 0 0px 2px rgba(0,0,0,0.5);
box-shadow: 0 1px 3px black;  
}

</style>
<script src="jquery.selectbox.min.js" type="text/javascript"></script>
<script src="jquery.js" type="text/javascript"></script>
      <script type="text/javascript">

				    /* Clear data from run zero */
function clearExistingData(){
   
   $.ajax({
     type: 'POST',
     url: "clearExistingData.php",
     success: function(data){
	 
       }
     });

   }

function threadSubmission(columnValue,entryValue,threadTypeValue,threadNameValue){  
  //alert(entryValue);
  /* AJAX query to get the PCs for a given run */
  $.ajax({
    type: 'POST',
	url: "threadSubmit.php",
	data: { column: columnValue, threadEntry: entryValue, threadType: threadTypeValue, threadName: threadNameValue }, 
	success: function(data){	       
      }
    });
}

function createPC(pc_name,ip,port){  

  // pc_name='FEPC1';
  //ip='192.134.432.0';
  //port='1717';

  /* AJAX query to get the PCs for a given run */
  $.ajax({
    type: 'POST',
	url: "createPC.php",
	data: { pcName: pc_name, IP: ip, Port: port },
	success: function(data){	       
      }
    });
}

function threadTemplateSlide(thechosenone) {
  //alert(thechosenone);
  $('.templateboxes').each(function(index) {
      //alert($(this).prop('id'));
			     if ($(this).prop('id') == thechosenone && ($(this).is(":visible"))==1) {
			       $(this).slideUp(200);
			     }
			     else if($(this).prop('id') == thechosenone)
			       {
				 $(this).slideDown(200);
			       }
			     else 
			       {
			       $(this).slideUp(600);
			       }
			   });
		       }

function addThreadSlide(thechosenone) {
  $('.createThread_SlideBox').each(function(index) {
			     if ($(this).prop('id') == thechosenone && ($(this).is(":visible"))==1) {
			       $(this).slideUp(200);
			     }
			     else if($(this).prop('id') == thechosenone)
			       {
				 $(this).slideDown(200);
			       }
			     else 
			       {
			       $(this).slideUp(600);
			       }
			   });
		       }


  /* Function to slide the threads up and down */
function threadSlide(thechosenone) {
			 $('.threadboxes').each(function(index) {
			     if ($(this).prop('id') == thechosenone && ($(this).is(":visible"))==1) {
			       $(this).slideUp(200);
			     }
			     else if(($(this).prop('id') == thechosenone))
			       {
				 $(this).slideDown(200);
			       }
			     else 
			       {
				 $(this).slideUp(600);
			       }
			   });
		       }

/* Function to slide the PC boxes up and down */
function pcSlide(thechosenone) {
			 $('.pcSlideBox').each(function(index) {
			     if ($(this).prop('id') == thechosenone && ($(this).is(":visible"))==1) {
			       $(this).slideUp(200);
			     }
			     else if($(this).prop('id') == thechosenone)
			       {
				 $(this).slideDown(200);
			       }
			     else 
			       {
				 $(this).slideUp(600);
			       }
			   });
		       }

/* Function to slide the "Create new PC..." menu up and down */
function addPCSlide(thechosenone) {
			 $('.createPC_SlideBox').each(function(index) {
			     if ($(this).prop('id') == thechosenone && ($(this).is(":visible"))==1) {
			       $(this).slideUp(200);
			     }
			     else if($(this).prop('id') == thechosenone)
                              {
				 $(this).slideDown(200);
			       }
			     else 
			       {
				 $(this).slideUp(600);
			       }
			   });
		       }
/* Function to slide the "Create new thread template..." menu up and down */
function addThreadTemplateSlide(thechosenone) {
			 $('.createThreadTemplate_SlideBox').each(function(index) {
			     if ($(this).prop('id') == thechosenone && ($(this).is(":visible"))==1) {
			       $(this).slideUp(200);
			     }
			     else if($(this).prop('id') == thechosenone)
			       {
				 $(this).slideDown(200);
			       }
			     else 
			       {
				 $(this).slideUp(600);
			       }
			   });
}		       

/*Function to slide the "Create new memory manager template..." menu up and down */				    
function addMMTemplateSlide(thechosenone) {
			 $('.createMMTemplate_SlideBox').each(function(index) {
			     if ($(this).prop('id') == thechosenone && ($(this).is(":visible"))==1) {
			       $(this).slideUp(200);
			     }
			     else if($(this).prop('id') == thechosenone)
			       {
				 $(this).slideDown(200);
			       }
			     else 
			       {
				 $(this).slideUp(600);
			       }
			   });
}
function copyRun(){
 	    var runSelector="#runcopy-dropdown";
	    selectedRun = $(runSelector).val();

	    var selectedRunSplit = selectedRun.split(':');
	    var selectedRunNumber = selectedRunSplit[0];

	  
	    $.ajax({
	      type: 'POST',
		  url: "copyRuns.php",
		  async: false,
		  data:{runNumber:selectedRunNumber},
		  success: function(data){
		}
	      }); 
}

				    $(document).ready(function(){

    var thread_types=new Array();
      //Create the dropdown menu to add a new PC (takes 3 inputs: pc_name,ip,port)
    var createPCDropdownTitle = "'createPC'";
    var createPC_MenuBar = '<div id="PC"><div class="createPC_Menu" id="createPC"><a id="createPC" href="javascript:addPCSlide(' + createPCDropdownTitle + ');" style="color:#696969;">&nbsp&nbsp Create new PC... &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</a><div>';
    var createPC_SlidingBox = '<div class="createPC_SlideBox" id="createPC" style="display: none; block:padding 5px; height:110px; position:relative;"><form>&nbsp PC Name: &nbsp&nbsp<input type="text" name="pcNameInput" class="pcNameInputBox"/><br />&nbsp IP Address: <input type="text" name="pcIPInput" class="pcIPInputBox"/><br />&nbsp Port: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<input type="text" name="pcPortInput" class="pcPortInputBox"/></form><button type="button" id="addpc" class="pcAddButton" >Add PC</button></div></div>';
    var createPCDropdown = createPC_MenuBar + createPC_SlidingBox;
    $("[id=runupload-dropdown]").after(createPCDropdown);

    //Create the dropdown menu to add a new thread template 
    var createThreadTemplateDropdownTitle = "'createThreadTemplate'";
    var createThreadTemplate_MenuBar = '<div id="newThreadTemplate"><div class="createThreadTemplate_Menu" id="createThreadTemplate"><a id="createThreadTemplate" href="javascript:addThreadTemplateSlide(' + createThreadTemplateDropdownTitle + ');" style="color:#696969;">&nbsp&nbsp Create new thread template... &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</a><div>';
    var createThreadTemplate_SlidingBox = '<div class="createThreadTemplate_SlideBox" id="createThreadTemplate" style="display: none; block:padding 5px; height:260px; position:relative;"><form>&nbsp Thread Type: &nbsp&nbsp&nbsp<input type="text" name="threadTypeInput" class="threadTypeInputBox"/><br />&nbsp Data 01: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<input type="text" name="data01Input" class="data01InputBox"/><br />&nbsp Data 02: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<input type="text" name="data02Input" class="data02InputBox"/><br />&nbsp Data 03: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<input type="text" name="data03Input" class="data03InputBox"/><br />&nbsp Data 04: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<input type="text" name="data04Input" class="data04InputBox"/><br />&nbsp Data 05: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<input type="text" name="data05Input" class="data05InputBox"/><br />&nbsp Data 06: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<input type="text" name="data06Input" class="data06InputBox"/><br />&nbsp Data 07: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<input type="text" name="data07Input" class="data07InputBox"/><br />&nbsp Data 08: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<input type="text" name="data08Input" class="data08InputBox"/></form><button type="button" id="addtemplate" class="threadTemplateAddButton" >Add Template</button></div></div>';
    var createThreadTemplateDropdown = createThreadTemplate_MenuBar + createThreadTemplate_SlidingBox;
    $("[id=PC]").after(createThreadTemplateDropdown);


    //Create the dropdown menu to add a new memory manager template 
    var createMMTemplateDropdownTitle = "'createMMTemplate'";
    var createMMTemplate_MenuBar = '<div id="newMMTemplate"><div class="createMMTemplate_Menu" id="createMMTemplate"><a id="createMMTemplate" href="javascript:addMMTemplateSlide(' + createMMTemplateDropdownTitle + ');" style="color:#696969;">&nbsp&nbsp Create new memory manager template... &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</a><div>';
    var createMMTemplate_SlidingBox = '<div class="createMMTemplate_SlideBox" id="createMMTemplate" style="display: none; block:padding 5px; height:260px; position:relative;"><form>&nbsp MM Type: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<input type="text" name="threadTypeInput" class="threadTypeInputBox"/><br />&nbsp Data 01: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<input type="text" name="data01Input" class="data01InputBox"/><br />&nbsp Data 02: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<input type="text" name="data02Input" class="data02InputBox"/><br />&nbsp Data 03: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<input type="text" name="data03Input" class="data03InputBox"/><br />&nbsp Data 04: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<input type="text" name="data04Input" class="data04InputBox"/><br />&nbsp Data 05: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<input type="text" name="data05Input" class="data05InputBox"/><br />&nbsp Data 06: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<input type="text" name="data06Input" class="data06InputBox"/><br />&nbsp Data 07: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<input type="text" name="data07Input" class="data07InputBox"/><br />&nbsp Data 08: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<input type="text" name="data08Input" class="data08InputBox"/></form><button type="button" id="addpc" class="mmTemplateAddButton" >Add Template</button></div></div>';
    var createMMTemplateDropdown = createMMTemplate_MenuBar + createMMTemplate_SlidingBox;
    $("[id=newThreadTemplate]").after(createMMTemplateDropdown);

    //alert("name almost");
    //Create the "Choose a run..." sliding menu bar
    $("[id=runupload-dropdown]").append('<option value="choose">Choose a run...</option>');
    $("[id=runcopy-dropdown]").append('<option value="copy">Quick Copy a run...</opion>');
    
    $.ajax({
	    type: 'GET',
		url: "getRuns.php",
		async: false,
		success: function(run_data){	       
		var runs=$.parseJSON(run_data);
		$.each(runs, function(runIndex,runValue){
		    
		    var selectRun = "'<option value=" + '"' + runValue + '"' + ">" + runValue + "</option>'";
		    
		    $("[id=runupload-dropdown]").append(selectRun);
		    $("[id=runcopy-dropdown]").append(selectRun);
		    
		  });
	
	}
      });
  
    

	    //Set the functionality for the "Add a PC" button on click
    $("#addpc").click(function() {
	$(".createPC_SlideBox").slideUp(200);
	var pcNameVal = $("input[name=pcNameInput]").val();
	var pcIPVal = $("input[name=pcIPInput]").val();
	var pcPortVal = $("input[name=pcPortInput]").val();
	var pcValue = pcNameVal + ":" + pcIPVal + ":" + pcPortVal;
	var PCString = "'" + pcValue + "'";
	 
	//Set the height of the box which drops down
	//	var pcBoxHeight=50;
	var pcExpand = '<div id="PC:' + pcNameVal + '"><div class="pcbutton" id="' + pcValue + '"><a id="' + pcValue + '" href="javascript:pcSlide(' + PCString + ');" style="color:#696969;">&nbsp&nbsp' + pcNameVal + '&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<button type="button" id="removepc" class="pcRemoveButton">Remove</button></a><div>';
	  
	var pcBox = '<div class="pcSlideBox" id="' + pcValue + '" style="display: none; block:padding 5px; height:' + pcBoxHeight + 'px; position:relative;"><button type="button" id="addthread" class="addThreadButton" >Add a Thread</button></div></div>';



	pcExpandingBox = pcExpand + pcBox;
	$('.pcSlideBox').prev().after(pcExpandingBox);

	  
	//Make the "Create new Thread" sliding menu
	var createThreadDropDownTitle="'createThread:" + pcNameVal + "'";

	var createThread_MenuBar='<div id="Thread:' + pcNameVal + '"><div class="createThread_Menu" id="createThread:' + pcNameVal + '"><a id="createThread:' + pcNameVal + '" href="javascript:addThreadSlide(' + createThreadDropDownTitle + ');" style="color:#696969;">&nbsp&nbsp Create new Thread... &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</a><div>';
	var createThread_SlidingBox='<div class="createThread_SlideBox" id="createThread:' + pcNameVal + '" style="display: none; block:padding 5px; height:100px; position:relative;"><form>&nbsp Thread Name: &nbsp&nbsp<input type="text" name="threadNameInput" class="threadNameInputBox"/></form></div</div>';// <select id="thread-dropdown" name="thread-d" class="runMenu"  style="position:absolute; width:20px; left:20px"><option value="choose">choose</option></select></div></div>';

	createThreadDropDown = createThread_MenuBar + createThread_SlidingBox;
	  
	var newPCSlideSelector = ".pcSlideBox";

	//eq(-2) seems vague but I do not know what this is equivalent to!!
	$(newPCSlideSelector).eq(-2).append(createThreadDropDown);

      });
      

    /* Make the Remove PC button remove PCs */
    $("#removepc").live("click", "#removepc", function() {
	var pc_conf = confirm("Are you sure you want to remove this PC?");
	if (pc_conf) {
	$(this).parent().parent().remove();
	}
      });

    $("#removeThread").live("click","#removeThread",function(){
	var thread_conf = confirm("Are you sure you want to remove this thread?");
	if (thread_conf) {
	$(this).parent().remove();
	}
      });

    $("#removeMM").live("click","#removeMM", function() {
	var mm_conf = confirm("Are you sure you want to remove this memory manager?");
	if (mm_conf) {
	  $(this).parent().parent().remove();
	}
      });

  
    $("[id=runcopy-dropdown]").change(function(){
	var answer=confirm("Load Selected Run?  This will delete current 'run zero' and load your setting in place.");
	if(answer)
	  {
	    clearExistingData();
	    
	    copyRun();
	    
	  }
	    		    
      });
    
    //    var selectedRunNumber = 0;
  $("[id=runupload-dropdown]").change(function(){	
      $(".pcbutton").empty();

      var runSelector = "#runupload-dropdown";
      var selectedRun = $(runSelector).val();
     
      var selectedRunSplit = selectedRun.split(':');
      var selectedRunNumber = selectedRunSplit[0];   

      var pcArray = new Array();
      /* AJAX query to get the PCs for a given run */
      $.ajax({
	type: 'POST',
	    url: "getPCs.php",
	    async: false,
	    data: { runNumber: selectedRunNumber },
	    success: function(pc_data){	       
	    var pcNames = $.parseJSON(pc_data);
	    index=0;
	    dataIndex=0;
	    dataIndex2=0;
	    //pcIndex = 0;
	
	    $.each(pcNames, function(pcIndex,pcValue) {
		var pcSplit=pcValue.split(":");
		var pcName=pcSplit[0];
 	        //NOW WE HAVE ALL OF THE PC VALUES
		pcArray[index] = pcName;
		index++;
	      });
	  }
	});

      //So now we have the set of PCs that have that given run on them! Yay
      var tIndex = 0;
      var pcFlags = new Array();
      var threadArray = new Array();
      for (var i=0;i<(pcArray.length);i++) {
	//	var pcTag = pcArray[i];
	/* AJAX query to get the threads for a given PC */
      var pcIterName =pcArray[i];
      $.ajax({
	type: 'POST',
	    url: "getThreads.php",
	    async: false,
	    data: { pcName: pcIterName, runNumber: selectedRunNumber },
	    success: function(thread_data){
	    var threads = $.parseJSON(thread_data);
	    $.each(threads,function(threadIndex,threadValue) {
		//threadValue has threadType:threadName in it
		var threadSplit = threadValue.split(':');
		var threadTypeValue = threadSplit[0];
		var threadNameValue = threadSplit[1];
		var this_threadType = "'" + threadTypeValue + "'";
		var this_threadName = "'" + threadNameValue + "'";
		threadArray[tIndex] = threadValue + ":" + pcIterName;
		tIndex++;
	      });
	  }
	}); 
      //These are the indices where the threads change the PCs
      pcFlags[i+1] = tIndex;
      }
      pcFlags[0] = 0;

      //Now use the array of thread names to look up the data in each of these threads. This array will just store the entire string of data; it gets parsed later
      //create the 2d array to store the data for each thread for each pc
      //note: format is [pc index][thread index]
      var dataArray = new Array(pcArray.length);
      for (var x = 0; x < (pcArray.length); x++) {
	var ta_length = pcFlags[x+1]-pcFlags[x];
	dataArray[x] = new Array(ta_length);
      }
      

      for (var pi=0; pi < (pcArray.length); pi++) {
	for (var ti=0; ti < (pcFlags[pi+1] - pcFlags[pi]); ti++) {
	  var pcName = pcArray[pi];
	  var threadVal = threadArray[ti].split(":");
	  var threadName = threadVal[0];
	  $.ajax({
	    type: 'POST',
		url: "getThreadData.php",
		async: false,
		data: {threadType: threadName, pcName: pcName},
		success: function(thread_data){
		dataArray[pi][ti] = thread_data;
		
	      }
	      });
	}
      }
      //Now the JSON strings holding all of the data for each string are stored in the array to be referenced by dataArray[pcname][threadname]
      //***reminder:some of them are empty strings - check before referencing
      
      //Get the memory managers for all of these PCs as well
      var mmIndex = 0;
      var mmPCFlags = new Array();
      var mmArray = new Array();
      for (var z=0; z < (pcArray.length); z++) {
	var mmIterName = pcArray[z];
      $.ajax({
	type: 'POST',
	    url: "getMMs.php",
	    async: false,
	    data: { pcName: mmIterName, runNumber: selectedRunNumber},
	    success: function(mm_data) {
	    var MMs = $.parseJSON(mm_data);
	    $.each(MMs,function(mIndex, mmValue){
		//mmValue has mmType:mmName in it
		var mmSplit = mmValue.split(':');
		var mmTypeValue = mmSplit[0];
 		var mmNameValue = mmSplit[1];
		var this_mmType = "'" + mmTypeValue + "'";
		var this_mmName = "'" + mmNameValue + "'";
		mmArray[mmIndex] = mmValue + ":" + pcIterName;
		mmIndex++;
	      });
	  }
	  }); 
      //These are the indices where the threads change the PCs
      mmPCFlags[z+1] = mmIndex;
      }
      mmPCFlags[0] = 0;

      var pcExpandingBox;
      var pcExpand;
      var pcBox;
      for (var j=0; j < (pcArray.length); j++) {
	//make the PC boxes
	var pcBoxHeight =((mmPCFlags[j+1] - mmPCFlags[j])+(pcFlags[j+1] - pcFlags[j])) * 22.5;
	var PCString = "'" + pcArray[j] + "'";
	var pcExpand = '<div id="PC' + pcArray[j] + '"><div class="pcbutton" id="' + pcArray[j]+ '"><a id="' + pcArray[j] + '" href="javascript:pcSlide(' + PCString + ');" style="color:#696969;">&nbsp&nbsp' + pcArray[j] + '&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<button type="button" id="removepc" class="pcRemoveButton">Remove</button></a><div>';
	/*
		      var pcValueSplit = pcArray[j].split(":");
		      var pcNameValue = pcValueSplit[0];
		      var pcIPValue = pcValueSplit[1];
		      var pcPortValue = pcValueSplit[2];

	*/

	var pcName = pcArray[j];
	var pcValue = pcName;

		      var pcBox = '<div class="pcSlideBox" id="' + pcArray[j] + '" style="display: none; block:padding 5px; height:' + pcBoxHeight + 'px; position:relative;"></div></div>';
		      pcExpandingBox = pcExpand + pcBox;
		      $(pcExpandingBox).insertAfter("#go");
      }

      var threadExpandingBox;
      var threadExpand;
      var threadBox;
      for (var j=0; j < (pcArray.length); j++) {
      
	//		      		      $(".pcSlideBox").innerHTML("");
	    for (var k = pcFlags[j]; k < pcFlags[j+1]; k++) {
	      //On each pc dropdown, make a little clicky box for "create a new thread"
	      /*
	      var createThreadDropDownTitle = "'createThread:" + pcNameVal + "'";
	      alert(createThreadDropDownTitle);

	      var createThread_MenuBar='<div id="Thread:' + pcValue + '"><div class="createThread_Menu" id="createThread:' + pcValue + '"><a id="createThread:' + pcValue + '" href="javascript:addThreadSlide(' + createThreadDropDownTitle + ');" style="color:#696969;">&nbsp&nbsp Create new thread... &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</a><div>';

	      var createThread_SlidingBox='<div class="createThread_SlideBox" id="createThread:' + pcValue + '" style="display: none; block:padding 5px; height:100px; position:relative;"><form>&nbsp Thread Name: &nbsp&nbsp<input type="text" name="threadNameInput" class="threadNameInputBox"/><br />&nbsp Thread Type: &nbsp&nbsp<select id="Thread_DD' + pcNameValue + '" name="Thread_DD' + pcNameValue + '" class="threadMenu"></select><br /><button type="button" id="addthread" class="addThreadButton" >Add Thread</button></form></div></div>';

	      createThreadDropDown = createThread_MenuBar + createThread_SlidingBox;
	      */
	      var threadSplit = threadArray[k].split(':');
	      var threadTypeValue = threadSplit[0];
	      var threadNameValue = threadSplit[1];
	      var threadPC = threadSplit[2];
	      var this_threadType = "'" + threadTypeValue + "'";
	      var this_threadName = "'" + threadNameValue + "'";

       	      threadExpand = '<div id="' + threadArray[k] + " " + pcArray[j] + '" class="threadbox"; ><a id="' + threadArray[k] + " " + pcArray[j] + '" href="javascript:threadSlide(' + threadArray[k] + " " + pcArray[j] + ');" >' + threadTypeValue + ' : '+ threadNameValue + '</a><button type="button" id="removeThread" class="threadRemoveButton">REMOVE</button><div>';

	      threadBox = '<div class="threadboxes" id="' + threadArray[k] + pcArray[j] + '"display: none; block: padding 5px; width: 500 px;></div>';

	      threadExpandingBox = threadExpand+threadBox;

	      var pcE = document.getElementById(pcArray[j]);
	      $(pcE).find('.pcSlideBox').append(threadExpandingBox);

	      //Now add the thread data for each of the boxes - pcindex = j, threadindex = k
	      //we have to parse the json string stored in that location
	      var tdata = $.parseJSON(dataArray[j][k]);
	      /*	      $.each(tdata,function(d_index,data) {
		  /*if (data.length == 0) {
		    data = "NULL";
		    }
		    //dataExpand = '<div class="databox" id="' + d_index + threadArray[k] + '"display: none; block: padding 5px; width: 500px;></div>';
		    }
	      */

		}
      
	    for (var m = mmPCFlags[j]; m < mmPCFlags[j+1]; m++) {
	      var mmSplit = mmArray[m].split(':');
	      var mmTypeValue = mmSplit[0];
	      var mmNameValue = mmSplit[1];
	      var mmPC = mmSplit[2];
	      var this_mmType = "'" + mmTypeValue + "'";
	      var this_mmName = "'" + mmNameValue + "'";
	      
	      var mmExpand = '<div id="' + mmArray[k] + " " + pcArray[j] + '" class="mmbox"; ><a id="' + mmArray[k] + " " + pcArray[j] + '" href="javascript:threadSlide(' + mmArray[k] + " " + pcArray[j] + ');" >' + mmTypeValue + ' : '+ mmNameValue + '</a><button type="button" id="removeMM" class="mmRemoveButton">REMOVE</button><div>';
	      
	      var mmBox = '<div class="mmboxes" id="' + mmArray[k] + pcArray[j] + '"display: none; block: padding 5px; width: 500 px;></div>';
	      var mmExpandingBox = mmExpand + mmBox;

	      var pcE = document.getElementById(pcArray[j]);
	      $(pcE).find('.pcSlideBox').append(mmExpandingBox);

	    }
      }


      
      

      
      
    });
				      
				      
  
  $("#go").live('click',function() {
      var answer=confirm("Load Selected Run?  This will delete current 'run zero' and load your setting in place.");
      if(answer)
	{
	  clearExistingData();
	  $(".pcbutton").each(function(){	     
	      var pcObj = $("#" + this.id + "");
	      var pcNameValue = pcObj.data("pcName");
	      var pcIPValue = pcObj.data("IP");
	      var pcPortValue = pcObj.data("port");		     

	      alert(pcNameValue);
	      createPC(pcNameValue,pcIPValue,pcPortValue);
	    });
	  
	 	}
    
    });
				      });
				   
				    
</script>
</head>
<body>


<div class=runCopyBox><select id="runcopy-dropdown" name="runcopy-dropdown" class="runCopyMenu"></select></div>
				    		

<select id="runupload-dropdown" name="runupload-dropdown" class="runMenu"></select>
<button type="button" id="go" class="goButton">Start Run</button>

</body>
</html>

